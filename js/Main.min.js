function open_add_class(){$(".modal").css("display","block")}function add_class(){(null!=hold_class||void 0!=hold_class)&&classes.splice(hold_class[1],1),generate_hourmarks(start_hour_marks,end_hour_marks);var e=$("#add-class-name").val(),t=$("#add-class-short-name").val();(""==t||null==t||void 0==t)&&(t=e);for(var n="#"+$("#add-class-color").val().slice(-6),i=[],r=[],s=[],o=0;o<$(".add-class-option").length;o++)i[o]=$("#reg-num"+o).val(),""==i[o]&&(i[o]="UNDEFINED"),r[o]=[$("#weekday-sun"+o).prop("checked"),$("#weekday-mon"+o).prop("checked"),$("#weekday-tue"+o).prop("checked"),$("#weekday-wed"+o).prop("checked"),$("#weekday-thu"+o).prop("checked"),$("#weekday-fri"+o).prop("checked"),$("#weekday-sat"+o).prop("checked")],s[o]=[$("#start-time"+o).val(),$("#end-time"+o).val()];if(validate_data(e,t,n,i,r,s)){classes[classes.length]=new Class(e,t,i,s,r,n);for(var o=$(".add-class-option").length-1;o>0;o--)$($(".add-class-option"))[o].remove();$("#add-class-form")[0].reset(),$(".modal").css("display","none"),reset_class_list();for(var o=0;o<s.length;o++)start_hour_marks=Math.min(start_hour_marks,parseInt(s[o][0].substr(0,2))),end_hour_marks=Math.max(end_hour_marks,parseInt(s[o][1].substr(0,2))+1);generate_hourmarks(start_hour_marks,end_hour_marks)}}function add_class_option(){var e=$(".add-class-option").length.toString();$("#add-class-form").append("<div id='option"+e+"' class='add-class-option'>Registration Number: <input type='text' id='reg-num"+e+"'><button id='remove-option0' onclick='javascript:remove_option("+e+");' style='float:right;'><i class='fa fa-minus' aria-hidden='true'></i></button><div id='days-of-week'><div class='title'>What days?</div><div class='weekDays-selector'><input type='checkbox' id='weekday-sun"+e+"' class='weekday' /><label for='weekday-sun"+e+"'>S</label><input type='checkbox' id='weekday-mon"+e+"' class='weekday' /><label for='weekday-mon"+e+"'>M</label><input type='checkbox' id='weekday-tue"+e+"' class='weekday' /><label for='weekday-tue"+e+"'>T</label><input type='checkbox' id='weekday-wed"+e+"' class='weekday' /><label for='weekday-wed"+e+"'>W</label><input type='checkbox' id='weekday-thu"+e+"' class='weekday' /><label for='weekday-thu"+e+"'>R</label><input type='checkbox' id='weekday-fri"+e+"' class='weekday' /><label for='weekday-fri"+e+"'>F</label><input type='checkbox' id='weekday-sat"+e+"' class='weekday' /><label for='weekday-sat"+e+"'>S</label></div></div>Start time: <input type='time' id='start-time"+e+"'> End time: <input type='time' id='end-time"+e+"'><br></div>")}function remove_option(e){for(var t=$(".add-class-option").length,n=e;t>n;n++)$("#reg-num"+n).val($("#reg-num"+(n+1)).val()),$("#weekday-sun"+n).prop("checked",$("#weekday-sun"+(n+1)).prop("checked")),$("#weekday-mon"+n).prop("checked",$("#weekday-mon"+(n+1)).prop("checked")),$("#weekday-tue"+n).prop("checked",$("#weekday-tue"+(n+1)).prop("checked")),$("#weekday-wed"+n).prop("checked",$("#weekday-wed"+(n+1)).prop("checked")),$("#weekday-thu"+n).prop("checked",$("#weekday-thu"+(n+1)).prop("checked")),$("#weekday-fri"+n).prop("checked",$("#weekday-fri"+(n+1)).prop("checked")),$("#weekday-sat"+n).prop("checked",$("#weekday-sat"+(n+1)).prop("checked")),$("#start-time"+n).val($("#start-time"+(n+1)).val()),$("#end-time"+n).val($("#end-time"+(n+1)).val());$($(".add-class-option")[t-1]).remove()}function edit_class(e){$(".modal").css("display","block");for(var t=0;t<classes[e].crns.length-1;t++)add_class_option();$("#add-class-name").val(classes[e].name),$("#add-class-short-name").val(classes[e].shortname),$("#add-class-color").val(classes[e].color);for(var t=0;t<classes[e].crns.length;t++)$("#reg-num"+t).val(classes[e].crns[t]),$("#weekday-sun"+t).prop("checked",classes[e].days[t][0]),$("#weekday-mon"+t).prop("checked",classes[e].days[t][1]),$("#weekday-tue"+t).prop("checked",classes[e].days[t][2]),$("#weekday-wed"+t).prop("checked",classes[e].days[t][3]),$("#weekday-thu"+t).prop("checked",classes[e].days[t][4]),$("#weekday-fri"+t).prop("checked",classes[e].days[t][5]),$("#weekday-sat"+t).prop("checked",classes[e].days[t][6]),$("#start-time"+t).val(classes[e].times[t][0]),$("#end-time"+t).val(classes[e].times[t][1]);hold_class=[classes[e],e],classes[e]=0}function cancel_class_edit(){classes[hold_class[1]]=hold_class[0],hold_class=null,$(".modal").css("display","none");for(var e=$(".add-class-option").length-1;e>0;e--)$($(".add-class-option"))[e].remove();$("#add-class-form")[0].reset(),generate_hourmarks(start_hour_marks,end_hour_marks)}function remove_class(e){classes.splice(e,1),reset_class_list()}function clear_class_list(){if(classes.length>0&&confirm("This will clear all classes from your list. Ok?")){for(var e=0;e<classes.length;e++)$("div.class"+e+"display").remove();classes=[],reset_class_list(),window.history.replaceState(null,null,"?"),generate_hourmarks(start_hour_marks,end_hour_marks)}}function validate_data(e,t,n,i,r,s){if(""==e||null==e||void 0==e)return alert("Your class needs a name!"),!1;if("#FFFFFF"==n){var o=confirm("The color for this class is still plain white. Is this ok?");if(!o)return!1}for(var a=0;a<i.length;a++){for(var l=a+1;l<i.length;l++)if(i[a]==i[l])return alert("Option #"+(a+1)+" and option #"+(l+1)+" have the same registration number!"),!1;if("UNDEFINED"==i[a]){var u=confirm("The registration number for this class is unset. Is this ok?");if(!u)return!1}if(""==i[a]||null==i[a]||void 0==i[a])return alert("There is a problem with your registration number. Please verify it is entered correctly."),!1;if(r[a]==[0,0,0,0,0,0,0])return alert("Must select at least one day in option #"+(a+1)),!1;if(s[a][0]=interpTime(s[a][0]),s[a][1]=interpTime(s[a][1]),0==s[0]||0==s[1])return alert("Option #"+(a+1)+" does not fit any time format must be one of: HH:MM am/pm, HH:MM (24hr), or HHMM (24hr)"),!1;if(parseInt(s[a][0].substr(0,2))>=parseInt(s[a][1].substr(0,2))){if(parseInt(s[a][0].substr(0,2))!=parseInt(s[a][1].substr(0,2)))return alert("Option #"+(a+1)+" ends before it begins!"),!1;if(parseInt(s[a][0].substr(3,5))>=parseInt(s[a][1].substr(3,5)))return alert("Option #"+(a+1)+" ends before it begins!"),!1}}return!0}function interpTime(e){var t=/^(((0?[1-9])|(1[0-2])):([0-5]\d)\s?(A|P|a|p)(M|m))$/,n=/^([0-1]?\d|2[0-3]):?([0-5]\d)$/;if(0==t.test(e)&&0==n.test(e))return!1;if(t.test(e)){var i=/^((0?[1-9])|(1[0-2])):/,r=/(P|p)(M|m)$/.test(e),s=i.exec(e)[1];r&&(s=(parseInt(s)+12).toString());var o=/:([0-5]\d)/,a=o.exec(e)[1],e=s+":"+a;return e}if(n.test(e)){var l=/([0-1]?\d|2[0-4])[0-5]\d/;if(l.test(e)){var a=e.substr(e.length-2),s=e.substr(0,e.length-2);/^\d$/.test(s)&&(s="0"+s);var e=s+":"+a;return e}return e=e}}function createString(){var e=JSON.stringify(classes);return Base64.encode(e)}function interpString(e){for(var t=Base64.decode(e),n=JSON.parse(t),i=[],r=0;r<n.length;r++)i[r]=new Class(n[r].name,n[r].shortname,n[r].crns,n[r].times,n[r].days,n[r].color,n[r].selected);return i}function createICS(e,t){var n="BEGIN:VCALENDAR\n";n+="PRODID:-//Google Inc//Google Calendar 70.9054//EN\n",n+="VERSION:2.0\n",n+="CALSCALE:GREGORIAN\n";for(var i=0;i<classes.length;i++)n+=classes[i].convertToICSString(e,t);return n+="END:VCALENDAR"}function openICSdialog(){$(".modal2").css("display","block")}function cancel_ics_export(){$(".modal2").css("display","none"),$("#ics-form")[0].reset()}function saveICS(){var e=$("#ics-start-date").val().replace("-","").replace("-",""),t=$("#ics-end-date").val().replace("-","").replace("-",""),n=createICS(e,t),i=document.createElement("a");if(i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(n)),i.setAttribute("download","schedule.ics"),document.createEvent){var r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),i.dispatchEvent(r)}else i.click();$(".modal2").css("display","none")}function verifyDate(e){var t=[31,28,31,30,31,30,31,31,30,31,30,31];return e.substr(0,4)%4==0&&(t[1]=29),8!=e.length?!1:e.substr(4,2)>12||e.substr(4,2)<0?!1:e.substr(6,2)>t[e.substr(4,2)-1]||e.substr(6,2)<0?!1:e.substr(0,4)<0?!1:!0}function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function random_color(){var e=Math.floor(256*Math.random()).toString(16);e=2==e.length?e:"0"+e;var t=Math.floor(256*Math.random()).toString(16);t=2==t.length?t:"0"+t;var n=Math.floor(256*Math.random()).toString(16);n=2==n.length?n:"0"+n,$("#add-class-color").val("#"+e+t+n)}function nthIndex(e,t,n){return e.split(t,n).join(t).length}function hexToRgb(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}var twentyfourhour=!1,start_hour_marks=7,end_hour_marks=18,classes=[],hold_class;$(window).on("load",function(){var e=getParameterByName("string");null!=e&&(classes=interpString(e)),generate_hourmarks(start_hour_marks,end_hour_marks),reset_class_list(),generate_hourmarks(start_hour_marks,end_hour_marks);for(var t=0;t<classes.length;t++)classes[t].add_to_calendar();$("#add-class-form").keypress(function(e){return e.which&&13==e.which||e.keyCode&&13==e.keyCode?(event.preventDefault(),add_class(),!1):!0})}),$(window).resize(function(){generate_hourmarks(start_hour_marks,end_hour_marks);for(var e=0;e<classes.length;e++)classes[e].add_to_calendar()});var generate_hourmarks=function(e,t){for(var n=t-e,i=$(".day").length,r=0;i>r;r++){$($(".day")[r]).find(".hour").remove();for(var s=0;n>s;s++)$($(".day")[r]).append('<div class="hour" id="hourdiv'+(e+s)+'"></div>')}var o=Math.floor(.9*$($(".day")[0]).height()/n);$(".hour").css({height:o.toString(),width:"100%","border-bottom":"1px solid #888"}),$(".hour-marks").empty();for(var r=0;n+1>r;r++){var a=e+r;if(twentyfourhour&&(labelnew=a%12,0==labelnew?labelnew=e+r:labelnew=labelnew,24==labelnew||0==labelnew?labelnew=12:labelnew=labelnew,a=12>a||24==a?labelnew.toString():labelnew.toString()),a=a.toString(),$(".hour-marks").append('<div class="hour-mark" id="hm'+r+'">'+a+"</div>"),r!=n){var l=$($(".hour")[r]).position().top-parseFloat($("#hms").css("font-size"));$("#hm"+r).css({position:"absolute",top:l.toString(),left:$(".hour-marks").position().left.toString()})}else{var l=$($(".hour")[r-1]).position().top+$($(".hour")[r]).height()-parseFloat($("#hms").css("font-size"))/2;$("#hm"+r).css({position:"absolute",top:l.toString(),left:$(".hour-marks").position().left.toString()})}}$(".hour-mark").css({width:$($(".hour-marks")[0]).width(),"text-align":"right"})},reset_class_list=function(){$("#classes-list").empty();for(var e=0;e<classes.length;e++)classes[e].add_to_list($("#classes-list"),twentyfourhour),classes[e].add_to_calendar();classes.length>0?window.history.replaceState(null,null,"?string="+createString()):window.history.replaceState(null,null,"?")};